{% extends 'web/base.html' %}

{% block content %}
<style>
    th a { color: #333; text-decoration: none; display: flex; align-items: center; justify-content: space-between; }
    th a:hover { color: #007bff; }
    .sort-icon { font-size: 12px; margin-left: 5px; color: #999; }
    th.active-sort { background-color: #e9ecef; }
    
    .song-link { text-decoration: none; color: #333; font-weight: bold; display: block; }
    .song-link:hover { color: #007bff; text-decoration: underline; }
</style>

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h2>–°–ø–∏—Å–æ–∫ –ø—ñ—Å–µ–Ω—å</h2>
    <a href="{% url 'song_create' %}" class="btn btn-primary">+ –î–æ–¥–∞—Ç–∏ –ø—ñ—Å–Ω—é</a>
</div>

<!-- üîç –ü–æ—à—É–∫ -->
<form method="get" style="margin-bottom: 20px; display: flex; gap: 10px;">
    <input type="text" name="q" class="form-control" placeholder="–ü–æ—à—É–∫ –ø—ñ—Å–µ–Ω—å –∞–±–æ –≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤..." value="{{ query }}">
    <button class="btn btn-secondary">–ü–æ—à—É–∫</button>
</form>

<table class="table table-striped">
    <thead>
        <tr>
            <th class="{% if current_sort == 'id' %}active-sort{% endif %}">
                <a href="?sort=id&order={% if current_sort == 'id' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    ID <span class="sort-icon">‚Üï</span>
                </a>
            </th>
            <th class="{% if current_sort == 'title' %}active-sort{% endif %}">
                <a href="?sort=title&order={% if current_sort == 'title' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    –ù–∞–∑–≤–∞ <span class="sort-icon">‚Üï</span>
                </a>
            </th>
            <th class="{% if current_sort == 'artist' %}active-sort{% endif %}">
                <a href="?sort=artist&order={% if current_sort == 'artist' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    –í–∏–∫–æ–Ω–∞–≤–µ—Ü—å <span class="sort-icon">‚Üï</span>
                </a>
            </th>
            <th class="{% if current_sort == 'album' %}active-sort{% endif %}">
                <a href="?sort=album&order={% if current_sort == 'album' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    –ê–ª—å–±–æ–º <span class="sort-icon">‚Üï</span>
                </a>
            </th>
            <th class="{% if current_sort == 'year' %}active-sort{% endif %}">
                <a href="?sort=year&order={% if current_sort == 'year' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    –†—ñ–∫ <span class="sort-icon">‚Üï</span>
                </a>
            </th>
            <th class="{% if current_sort == 'duration' %}active-sort{% endif %}">
                <a href="?sort=duration&order={% if current_sort == 'duration' and current_order == 'asc' %}desc{% else %}asc{% endif %}">
                    –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å <span class="sort-icon">‚Üï</span>
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for song in songs %}
        <tr>
            <td>{{ song.pk }}</td>
            <td><a href="{% url 'song_detail' pk=song.pk %}" class="song-link">{{ song.title }}</a></td>
            <td>
                {% if song.main_artist %}
                    <a href="{% url 'artist_detail' pk=song.main_artist.pk %}" style="text-decoration: none; color: #007bff;">
                        {{ song.main_artist.nickname }}
                    </a>
                {% else %}-{% endif %}
            </td>
            <td>{{ song.album.title|default:"-" }}</td>
            <td>{{ song.release_year }}</td>
            <td>{{ song.duration|time:"i:s" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="6" style="text-align: center;">–°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
